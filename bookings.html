<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª | Ù‚ØµØ± Ø§Ù„Ù…Ø§Ø³Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="assets/css/style.css" rel="stylesheet">
</head>
<body>

<div class="header">
<button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>
<h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h4>
</div>

<div class="overlay" id="overlay" onclick="closeSidebar()"></div>

<div class="sidebar" id="sidebar">
<a href="index.html">ğŸ  Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a>
<a href="clients.html">ğŸ‘¥ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</a>
<a href="bookings.html" class="active-link">ğŸ“… Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</a>
<a href="payments.html">ğŸ’° Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</a>
<a href="reports.html">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
</div>

<div class="main">

<div class="card-box mb-4">

<form id="bookingForm" style="display:flex;gap:10px;flex-wrap:wrap;">

<select id="clientSelect" class="form-control" required></select>

<input type="number" id="total" class="form-control" placeholder="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù‚Ø¯" required>

<input type="date" id="date" class="form-control" required>

<button class="btn-main">Ø­ÙØ¸ Ø§Ù„Ø­Ø¬Ø²</button>

</form>

</div>

<div class="card-box">

<table class="table-custom">
<thead>
<tr>
<th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
<th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
<th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
<th>Ø­Ø°Ù</th>
</tr>
</thead>
<tbody id="bookingTable"></tbody>
</table>

</div>

</div>

<script src="assets/js/app.js"></script>

<script>

let clients = JSON.parse(localStorage.getItem("clients")) || [];
let bookings = JSON.parse(localStorage.getItem("bookings")) || [];

/* ØªÙ†Ø¸ÙŠÙ Ø£ÙŠ Ø­Ø¬Ø² ÙÙŠÙ‡ Ø®Ø·Ø£ */
bookings = bookings.filter(b => 
clients.some(c => Number(c.id) === Number(b.clientId))
);

localStorage.setItem("bookings", JSON.stringify(bookings));

function saveBookings(){
localStorage.setItem("bookings", JSON.stringify(bookings));
}

function loadClients(){
clientSelect.innerHTML="";
clients.forEach(c=>{
clientSelect.innerHTML += `
<option value="${Number(c.id)}">${c.name}</option>`;
});
}

function renderBookings(){
bookingTable.innerHTML="";

bookings.forEach(b=>{
let client = clients.find(c=>Number(c.id) === Number(b.clientId));

bookingTable.innerHTML+=`
<tr>
<td>${client ? client.name : "ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"}</td>
<td>${b.total} Ø±ÙŠØ§Ù„</td>
<td>${b.date}</td>
<td>
<button class="delete-btn" onclick="deleteBooking(${b.id})">
ğŸ—‘
</button>
</td>
</tr>`;
});
}

function deleteBooking(id){
bookings = bookings.filter(b=>Number(b.id)!==Number(id));
saveBookings();
renderBookings();
}

bookingForm.addEventListener("submit",function(e){
e.preventDefault();

if(!clientSelect.value){
alert("Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹");
return;
}

bookings.push({
id: Date.now(),
clientId: Number(clientSelect.value),
total: Number(total.value),
date: date.value
});

saveBookings();
this.reset();
renderBookings();
});

loadClients();
renderBookings();

</script>

</body>
</html>
