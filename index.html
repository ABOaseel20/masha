<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ù‚ØµØ± Ø§Ù„Ù…Ø§Ø³Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

<style>
body{
font-family:'Cairo',sans-serif;
transition:.3s;
overflow-x:hidden;
}

body.dark{
background:#0d1117;
color:#f1f1f1;
}

body.light{
background:#f4f6f9;
color:#222;
}

/* Sidebar */
.sidebar{
width:260px;
min-height:100vh;
background:#161b22;
position:fixed;
right:0;
top:0;
padding:20px;
transition:.3s;
z-index:1000;
}

.sidebar.closed{
right:-260px;
}

.sidebar a{
color:#ddd;
display:block;
padding:12px;
border-radius:10px;
margin-bottom:10px;
text-decoration:none;
font-weight:600;
}

.sidebar a:hover{
background:linear-gradient(45deg,gold,orange);
color:black;
}

/* Main */
.main{
margin-right:260px;
padding:25px;
transition:.3s;
}

.main.full{
margin-right:0;
}

/* Cards */
.card-custom{
border-radius:16px;
background:#1f2937;
color:white;
box-shadow:0 8px 30px rgba(0,0,0,0.4);
border:1px solid rgba(255,215,0,0.3);
padding:25px;
height:100%;
}

body.light .card-custom{
background:white;
color:black;
}

/* Spacing */
.row.gap-cards > div{
margin-bottom:25px;
}

/* Loader */
.loader{
position:fixed;
width:100%;
height:100%;
background:black;
display:flex;
justify-content:center;
align-items:center;
z-index:9999;
}

.loader img{
width:100px;
animation:spin 2s linear infinite;
}

@keyframes spin{
100%{transform:rotate(360deg);}
}

/* Responsive */
@media(max-width:991px){
.sidebar{
right:-260px;
}
.main{
margin-right:0;
padding:15px;
}
}
</style>
</head>

<body class="dark">

<!-- Loader -->
<div class="loader">
<img src="assets/img/diamond.png">
</div>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
<h4 class="text-warning text-center mb-4">ğŸ’ Ø§Ù„Ù…Ø§Ø³Ø©</h4>
<a href="index.html">ğŸ  Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a>
<a href="clients.html">ğŸ‘¥ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</a>
<a href="bookings.html">ğŸ“… Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</a>
<a href="payments.html">ğŸ’° Ø§Ù„Ø¯ÙØ¹Ø§Øª</a>
<a href="reports.html">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
</div>

<!-- Main -->
<div class="main" id="main">

<div class="d-flex justify-content-between align-items-center mb-4">
<h3 class="text-warning fw-bold">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
<div>
<button onclick="toggleMode()" class="btn btn-outline-warning">ğŸŒ™ / â˜€</button>
<button onclick="toggleSidebar()" class="btn btn-outline-light">â˜°</button>
</div>
</div>

<!-- Cards -->
<div class="row gap-cards mb-4">

<div class="col-lg-4 col-md-6 col-12">
<div class="card card-custom text-center">
<h6>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h6>
<div class="fs-3 fw-bold" id="bCount">0</div>
</div>
</div>

<div class="col-lg-4 col-md-6 col-12">
<div class="card card-custom text-center">
<h6>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h6>
<div class="fs-3 fw-bold" id="rev">0</div>
</div>
</div>

<div class="col-lg-4 col-md-6 col-12">
<div class="card card-custom text-center">
<h6>Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</h6>
<div class="fs-3 fw-bold" id="rem">0</div>
</div>
</div>

</div>

<!-- Chart -->
<div class="card card-custom mb-4">
<h5 class="mb-3">Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h5>
<canvas id="chart"></canvas>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>

let clients = JSON.parse(localStorage.getItem("clients")) || [];
let bookings = JSON.parse(localStorage.getItem("bookings")) || [];
let payments = JSON.parse(localStorage.getItem("payments")) || [];

function totalRevenue(){
return payments.reduce((s,p)=>s+Number(p.amount),0);
}

function remaining(bookingId){
let booking=bookings.find(b=>b.id==bookingId);
if(!booking) return 0;
let paid=payments.filter(p=>p.bookingId==bookingId)
.reduce((s,p)=>s+Number(p.amount),0);
return booking.total - paid;
}

function toggleSidebar(){
document.getElementById("sidebar").classList.toggle("closed");
document.getElementById("main").classList.toggle("full");
}

function toggleMode(){
if(document.body.classList.contains("dark")){
document.body.classList.remove("dark");
document.body.classList.add("light");
localStorage.setItem("theme","light");
}else{
document.body.classList.remove("light");
document.body.classList.add("dark");
localStorage.setItem("theme","dark");
}
}

window.onload=function(){

document.querySelector(".loader").style.display="none";

let savedTheme=localStorage.getItem("theme") || "dark";
document.body.classList.add(savedTheme);

document.getElementById("bCount").innerText=bookings.length;
document.getElementById("rev").innerText=totalRevenue()+" Ø±ÙŠØ§Ù„";

let totalRem=bookings.reduce((s,b)=>s+remaining(b.id),0);
document.getElementById("rem").innerText=totalRem+" Ø±ÙŠØ§Ù„";

new Chart(document.getElementById("chart"),{
type:"line",
data:{
labels:payments.map(p=>p.date),
datasets:[{
label:"Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",
data:payments.map(p=>p.amount),
borderColor:"gold",
backgroundColor:"rgba(255,215,0,0.2)",
fill:true,
tension:.4
}]
}
});
}
</script>

</body>
</html>
